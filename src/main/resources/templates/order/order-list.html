<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>My Orders</title>
    <link rel="stylesheet" th:href="@{/css/order-list.css}">
</head>
<body>
<div layout:fragment="body">
    <div th:replace="~{order/order-list :: content}"></div>
</div>
    <div th:fragment="content" class="orders-page">

        <h2 class="page-title">My Orders</h2>

        <div th:if="${!hasOrders}">
            <p>You have no orders yet.</p>
        </div>

        <div th:each="o : ${orders}" class="order-card">

            <div class="order-header">
                <div class="order-meta">
                    <div class="order-no" th:text="${'Order #' + o.orderId}"></div>
                    <div class="order-date"
                         th:text="${#temporals.format(o.orderDate, 'dd MMM yyyy, HH:mm')}"></div>
                </div>

                <div class="order-actions">
                    <span class="status-badge" th:classappend="${' badge-' + o.status.color}">
                        <span th:text="${o.status.label}"></span>
                    </span>

                    <a class="detail-btn"
                       th:href="@{/order/detail/{id}(id=${o.orderId})}">
                        View Details
                    </a>
                </div>
            </div>

            <div class="order-stepper" th:if="${o.status.step != -1}">
                <div class="step" th:classappend="${o.status.step} >= 0 ? ' active'">
                    <div class="dot"></div>
                    <div class="label">Awaiting Payment</div>
                </div>
                <div class="line" th:classappend="${o.status.step} >= 1 ? ' active'"></div>

                <div class="step" th:classappend="${o.status.step} >= 1 ? ' active'">
                    <div class="dot"></div>
                    <div class="label">Processing</div>
                </div>
                <div class="line" th:classappend="${o.status.step} >= 2 ? ' active'"></div>

                <div class="step" th:classappend="${o.status.step} >= 2 ? ' active'">
                    <div class="dot"></div>
                    <div class="label">Shipped</div>
                </div>
                <div class="line" th:classappend="${o.status.step} >= 3 ? ' active'"></div>

                <div class="step" th:classappend="${o.status.step} >= 3 ? ' active'">
                    <div class="dot"></div>
                    <div class="label">Delivered</div>
                </div>
            </div>

            <div class="cancelled-box" th:if="${o.status.step == -1}">
                This order has been cancelled.
            </div>

            <div class="order-items">
                <div class="item-row" th:each="i : ${o.items}">
                    <img class="item-img" th:src="${i.imageUrl}" alt="product">

                    <div class="item-info">
                        <div class="item-name" th:text="${i.productName}"></div>
                        <div class="item-qty"
                             th:text="${i.quantity + ' x ' + i.unitPrice + '€'}"></div>
                    </div>

                    <div class="item-total" th:text="${i.lineTotal + '€'}"></div>
                </div>
            </div>

            <div class="order-footer">
                <div class="total-text">Total</div>
                <div class="total-price" th:text="${o.totalPrice + '€'}"></div>
            </div>

        </div>

    </div>

</body>
</html>
